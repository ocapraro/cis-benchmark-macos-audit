[
  {
    "description": "Software vendors release security patches and software updates for their products\nwhen security vulnerabilities are discovered. There is no simple way to complete this\naction without a network connection to an Apple software repository. Please ensure\nappropriate access for this control. This check is only for what Apple provides through\nsoftware update.\nSoftware updates should be run at minimum every 30 days. Run the following command\nto verify when software update was previously run:\n$ /usr/bin/sudo defaults read\n/Library/Preferences/com.apple.SoftwareUpdate | grep -e\nLastFullSuccessfulDate.\nThe response should be in the last 30 days (Example): LastFullSuccessfulDate =\n\"2020-07-30 12:45:25 +0000\";",
    "id": "1_1",
    "regex": "No new software available",
    "result": "fail",
    "time": 5577,
    "title": "1.1 Ensure All Apple-provided Software Is Current (Automated)"
  },
  {
    "description": "Auto Update verifies that your system has the newest security patches and software\nupdates. If \"Automatically check for updates\" is not selected, background updates for\nnew malware definition files from Apple for XProtect and Gatekeeper will not occur.\nhttp://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/\nhttps://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-\nmavericks-and-yosemite/",
    "id": "1_2",
    "regex": "true",
    "result": "fail",
    "time": 35,
    "title": "1.2 Ensure Auto Update Is Enabled (Automated)"
  },
  {
    "description": "In the GUI, both \"Install macOS updates\" and \"Install app updates from the App Store\" are dependent on whether \"Download new updates when available\" is selected.",
    "id": "1_3",
    "regex": "true",
    "result": "success",
    "time": 26,
    "title": "1.3 Ensure Download New Updates When Available Is Enabled (Automated)"
  },
  {
    "description": "Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to test first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off simply to allow the administrator to contact users in order to verify installation. A dependable, repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.",
    "id": "1_4",
    "regex": "true",
    "result": "success",
    "time": 27,
    "title": "1.4 Ensure Install of macOS Updates Is Enabled (Automated)"
  },
  {
    "description": "Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or administrator privileges for end users.",
    "id": "1_5",
    "regex": "true",
    "result": "fail",
    "time": 26,
    "title": "1.5 Ensure Install Application Updates from the App Store Is Enabled (Automated)"
  },
  {
    "description": "Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper. With this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights. Apple has introduced a security feature that allows for smaller downloads and the installation of security updates when a reboot is not required. This feature is only available when the last regular update has already been applied. This feature emphasizes that a Mac must be up-to-date on patches so that Apple's security tools can be used to quickly patch when a rapid response is necessary.",
    "id": "1_6",
    "regex": "true",
    "result": "success",
    "time": 26,
    "title": "1.6 Ensure Install Security Responses and System Files Is Enabled (Automated)"
  },
  {
    "description": "A firewall is a piece of software that blocks unwanted incoming connections to a system.",
    "id": "2_1_1",
    "regex": "true",
    "result": "success",
    "time": 27,
    "title": "2.1.1 Ensure Firewall Is Enabled (Automated)"
  },
  {
    "description": "While in Stealth mode, the computer will not respond to unsolicited probes, dropping that traffic.",
    "id": "2_1_2",
    "regex": "Firewall stealth mode is on",
    "result": "success",
    "time": 7,
    "title": "2.1.2 Ensure Firewall Stealth Mode Is Enabled (Automated)"
  },
  {
    "description": "Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.\n\nNote: If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required, use the Date & Time System Preference with each server separated by a space. \n\nAdditional Note: The default Apple time server is time.apple.com. Variations include time.euro.apple.com. While it is certainly more efficient to use internal time servers, there is no reason to block access to global Apple time servers or to add a time.apple.com alias to internal DNS records. There are no reports that Apple gathers any information from NTP synchronization, as the computers already phone home to Apple for Apple services including iCloud use and software updates. Best practice is to allow DNS resolution to an authoritative time service for time.apple.com, preferably to connect to Apple servers, but local servers are acceptable as well.",
    "id": "2_2_1_1",
    "regex": "On",
    "result": "fail",
    "time": 23,
    "title": "2.2.1.1 Ensure Set Time and Date Automatically Is Enabled (Automated)"
  },
  {
    "description": "In macOS 10.14, Apple replace ntp with timed for time services, and is used to ensure correct time is kept. Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.",
    "id": "2_2_1_2",
    "regex": "1",
    "result": "success",
    "time": 14,
    "title": "2.2.1.2 Ensure the Time Service Is Enabled (Automated)"
  },
  {
    "description": "Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.",
    "id": "2_2_2_1",
    "regex": "Remote Apple Events: Off",
    "result": "success",
    "time": 20,
    "title": "2.2.2.1 Ensure Remote Apple Events Is Disabled (Automated)"
  },
  {
    "description": "Starting with 10.13 (macOS High Sierra), Apple introduced a service to make it easier to deploy data from Apple, including software updates, where there are bandwidth constraints to the Internet and fewer constraints or greater bandwidth exist on the local subnet. This capability can be very valuable for organizations that have throttled and possibly metered Internet connections. In heterogeneous enterprise networks with multiple subnets, the effectiveness of this capability would be determined by how many Macs were on each subnet at the time new, large updates were made available upstream. This capability requires the use of mac OS clients as P2P nodes for updated Apple content. Unless there is a business requirement to manage operational Internet connectivity and bandwidth, user endpoints should not store content and act as a cluster to provision data.",
    "id": "2_2_2_2",
    "regex": "false",
    "result": "success",
    "time": 27,
    "title": "2.2.2.2 Ensure Content Caching Is Disabled (Automated)"
  },
  {
    "description": "Apple provides a mechanism to send diagnostic and analytics data back to Apple to help them improve the platform. Information sent to Apple may contain internal organizational information that should be controlled and not available for processing by Apple. Turn off all Analytics and Improvements sharing.",
    "id": "2_3_1",
    "regex": "0\n0\n2",
    "result": "success",
    "time": 38,
    "title": "2.3.1 Ensure Sending Diagnostic and Usage Data to Apple Is Disabled (Automated)"
  },
  {
    "description": "Apple provides a framework that allows advertisers to target Apple users and end-users with advertisements. While many people prefer to see advertising that is relevant to them and their interests, the detailed information that is collected, correlated, and available to advertisers in repositories via data mining is often disconcerting. This information is valuable to both advertisers and attackers, and has been used with other metadata to reveal users' identities.",
    "id": "2_3_2",
    "regex": "0",
    "result": "success",
    "time": 15,
    "title": "2.3.2 Ensure Limit Ad Tracking Is Enabled (Automated)"
  },
  {
    "description": "Gatekeeper is Apple's application that utilizes allowlisting to restrict downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization. In an update to Gatekeeper in macOS 13 Ventura, Gatekeeper checks every application on every launch, not just quarantined apps.",
    "id": "2_3_3",
    "regex": "assessments enabled",
    "result": "success",
    "time": 14,
    "title": "2.3.3 Ensure Gatekeeper Is Enabled (Automated)"
  },
  {
    "description": "A locking screen saver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In macOS, the screen saver starts after a value is selected in the drop- down menu. 20 minutes or less is an acceptable value. Any value can be selected through the command line or script, but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.",
    "id": "2_4_1",
    "regex": "^Checking User: '/Users/[^']+': (?:[0-9]{1,3}|1[01][0-9]{2}|1200)$",
    "result": "success",
    "time": 21,
    "title": "2.4.1 Ensure an Inactivity Interval of 20 Minutes Or Less for the Screen Saver Is Enabled (Automated)"
  },
  {
    "description": "Sleep and screen saver modes are low power modes that reduce electrical consumption while the system is not in use.",
    "id": "2_4_2",
    "regex": "screenLock delay is (?:immediate|[1-5] seconds?)",
    "result": "fail",
    "time": 23,
    "title": "2.4.2 Ensure Require Password After Screen Saver Begins or Display Is Turned Off Is Enabled for 5 Seconds or Immediately (Automated)"
  },
  {
    "description": "An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.",
    "id": "2_4_3",
    "regex": ".+",
    "result": "success",
    "time": 26,
    "title": "2.4.3 Ensure a Custom Message for the Login Screen Is Enabled (Automated)"
  },
  {
    "description": "The login window prompts a user for his/her credentials, verifies their authorization level, and then allows or denies the user access to the system.",
    "id": "2_4_4",
    "regex": "true",
    "result": "fail",
    "time": 26,
    "title": "2.4.4 Ensure Login Window Displays as Name and Password Is Enabled (Automated)"
  },
  {
    "description": "Password hints are user-created text displayed when an incorrect password is used for an account.",
    "id": "2_4_5",
    "regex": "0",
    "result": "fail",
    "time": 26,
    "title": "2.4.5 Ensure Show Password Hints Is Disabled (Automated)"
  },
  {
    "description": "Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.",
    "id": "2_5_1",
    "regex": "^[^\\s]*$",
    "result": "success",
    "time": 30,
    "title": "2.5.1 Ensure Users' Accounts Do Not Have a Password Hint (Automated)"
  },
  {
    "description": "The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes and cannot remotely login to the system. All files, caches, and passwords created by the guest user are deleted upon logging out.",
    "id": "2_6_1",
    "regex": "false",
    "result": "success",
    "time": 26,
    "title": "2.6.1 Ensure Guest Account Is Disabled (Automated)"
  },
  {
    "description": "Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.",
    "id": "2_6_2",
    "regex": "SMB guest access disabled",
    "result": "fail",
    "time": 18,
    "title": "2.6.2 Ensure Guest Access to Shared Folders Is Disabled (Automated)"
  },
  {
    "description": "The automatic login feature saves a user's system access credentials and bypasses the login screen. Instead, the system automatically loads to the user's desktop screen.",
    "id": "2_6_3",
    "regex": "true",
    "result": "success",
    "time": 26,
    "title": "2.6.3 Ensure Automatic Login Is Disabled (Automated)"
  },
  {
    "description": "macOS's audit facility, auditd, receives notifications from the kernel when certain system calls, such as open, fork, and exit, are made. These notifications are captured and written to an audit log. \n\nApple has deprecated auditd as of macOS 11.0 Big Sur. In macOS 14.0 Sonoma it is no longer enabled by default and it is suggested to use an application that integrates with the EndpointSecurity API. These applications are 3rd party and not built into the macOS. Until auditd is removed from macOS completely, running the binary is the best way to collect logging in macOS and the only one that is part of the OS.",
    "id": "3_1",
    "regex": "com\\.apple\\.auditd",
    "result": "success",
    "time": 14,
    "title": "3.1 Ensure Security Auditing Is Enabled (Automated)"
  },
  {
    "description": "Auditing is the capture and maintenance of information about security-related events. Auditable events often depend on differing organizational requirements.",
    "id": "3_2",
    "regex": "flags:ad,aa,lo,\\-all",
    "result": "success",
    "time": 14,
    "title": "3.2 Ensure Security Auditing Flags For User-Attributable Events Are Configured Per Local Organizational Requirements (Automated)"
  },
  {
    "description": "macOS writes information pertaining to system-related events to the file /var/log/install.log and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization. \n\nThe default value has an \"all_max\" file limitation, no reference to a minimum retention, and a less precise rotation argument. \n\nThe all_max flag control will remove old log entries based only on the size of the log files. Log size can vary widely depending on how verbose installing applications are in their log entries. The decision here is to ensure that logs go back a year, and depending on the applications a size restriction could compromise the ability to store a full year. \n\nWhile this Benchmark is not scoring for a rotation flag, the default rotation is sequential rather than using a timestamp. Auditors may prefer timestamps in order to simply review specific dates where event information is desired.",
    "id": "3_3",
    "regex": "ttl=(?:36[5-9]|3[7-9]\\d|[4-9]\\d{2,}|[1-9]\\d{3,})",
    "result": "success",
    "time": 13,
    "title": "3.3 Ensure install.log Is Retained for 365 or More Days and No Maximum Size (Automated)"
  },
  {
    "description": "The macOS audit capability contains important information to investigate security or operational issues. This resource is only completely useful if it is retained long enough to allow technical staff to find the root cause of anomalies in the records. \n\nRetention can be set to respect both size and longevity. To retain as much as possible under a certain size, the recommendation is to use the following: \n\nexpire-after:60d OR 5G \n\nThis recomendation is based on minimum storage for review and investigation. When a third party tool is in use to allow remote logging or the store and forwarding of logs, this local storage requirement is not required.",
    "id": "3_4",
    "regex": "expire-after:\\s*(?:[6-9]\\d{1,}d|[1-9]\\d{3,}d|5G)",
    "result": "error",
    "time": 14,
    "title": "3.4 Ensure Security Auditing Retention Is Enabled (Automated)"
  },
  {
    "description": "The audit system on macOS writes important operational and security information that can be both useful for an attacker and a place for an attacker to attempt to obfuscate unwanted changes that were recorded. As part of defense-in-depth, the /etc/security/audit_control configuration and the files in /var/audit should be owned only by root with group wheel with read-only rights and no other access allowed. macOS ACLs should not be used for these files. \n\nThe default folder for storing logs is /var/audit, but it can be changed. This recommendation will ensure that any target directory has appropriate access control in place even if the target directory is not the default of /var/audit.",
    "id": "3_5",
    "regex": ".*",
    "result": "success",
    "time": 116,
    "title": "3.5 Ensure Access to Audit Records Is Controlled (Automated)"
  },
  {
    "description": "The socketfilter Firewall is what is used when the Firewall is turned on in the Security & Privacy Preference Pane. In order to appropriately monitor what access is allowed and denied, logging must be enabled. The logging level must be set to \"detailed\" to be useful in monitoring connection attempts that the firewall detects. Throttled login is not sufficient for examining Firewall connection attempts. \n\nIn-depth log monitoring on macOS may require changes to the \"Enable-Private-Data\" key in SystemLogging.System to ensure more complete logging.",
    "id": "3_6",
    "regex": "true",
    "result": "fail",
    "time": 25,
    "title": "3.6 Ensure Firewall Logging Is Enabled and Configured (Automated)"
  },
  {
    "description": "Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerates devices and services within a local subnet. DNS on macOS is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.",
    "id": "4_1",
    "regex": "true",
    "result": "success",
    "time": 26,
    "title": "4.1 Ensure Bonjour Advertising Services Is Disabled (Automated)"
  },
  {
    "description": "macOS used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. Apache, however, is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end-user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.",
    "id": "4_2",
    "regex": "0",
    "result": "error",
    "time": 15,
    "title": "4.2 Ensure HTTP Server Is Disabled (Automated)"
  },
  {
    "description": "macOS can act as an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end-user computer. \n\nThe etc/exports file contains the list of NFS shared directories. If the file exists, it is likely that NFS sharing has been enabled in the past or may be available periodically. As an additional check, the audit verifies that there is no /etc/exports file.",
    "id": "4_3",
    "regex": "0.*No Such File",
    "result": "error",
    "time": 25,
    "title": "4.3 Ensure NFS Server Is Disabled (Automated)"
  },
  {
    "description": "By default, macOS allows all valid users into the top level of every other user's home folder and restricts access to the Apple default folders within. Another user on the same system can see you have a \"Documents\" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system. \n\nThe best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures. Similarly with macOS, users can see into every new Directory that is created because of the default permissions. \n\nHome folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable.",
    "id": "5_1_1",
    "regex": "^$",
    "result": "error",
    "time": 13,
    "title": "5.1.1 Ensure Home Folders Are Secure (Automated)"
  },
  {
    "description": "Apple Mobile File Integrity (AMFI) was first released in macOS 10.12. The daemon and service block attempts to run unsigned code. AMFI uses launchd, code signatures, certificates, entitlements, and provisioning profiles to create a filtered entitlement dictionary for an app. AMFI is the macOS kernel module that enforces code-signing and library validation.",
    "id": "5_1_2",
    "regex": "0",
    "result": "error",
    "time": 14,
    "title": "5.1.2 Ensure Apple Mobile File Integrity (AMFI) Is Enabled (Automated)"
  },
  {
    "description": "Signed System Volume is a security feature introduced in macOS 11.0 Big Sur.\n\nDuring system installation, a SHA-256 cryptographic hash is calculated for all immutable system files and stored in a Merkle tree which itself is hashed as the Seal. Both are stored in the metadata of the snapshot created of the System volume. \n\nThe seal is verified by the boot loader at startup. macOS will not boot if system files have been tampered with. If validation fails, the user will be instructed to reinstall the operating system. \n\nDuring read operations for files located in the Signed System Volume, a hash is calculated and compared to the value stored in the Merkle tree.\n\nIf SSV has been disabled, assume that the operating system has been compromised. Back up any files, and do a clean install to a known good Operating System.",
    "id": "5_1_3",
    "regex": "Authenticated Root status: enabled",
    "result": "success",
    "time": 89,
    "title": "5.1.3 Ensure Signed System Volume (SSV) Is Enabled (Automated)"
  },
  {
    "description": "Applications in the System Applications Directory (/Applications) should be world- executable since that is their reason to be on the system. They should not be world- writable and allow any process or user to alter them for other processes or users to then execute modified versions.",
    "id": "5_1_4",
    "regex": "0",
    "result": "success",
    "time": 1593,
    "title": "5.1.4 Ensure Appropriate Permissions Are Enabled for System Wide Applications (Automated)"
  },
  {
    "description": "Software sometimes insists on being installed in the /System/Volumes/Data/System Directory and has inappropriate world-writable permissions. \n\nMacs with writable files in System should be investigated forensically. A file with open writable permissions is a sign of at best a rogue application. It could also be a sign of a computer compromise and a persistent presence on the system.",
    "id": "5_1_5",
    "regex": "0",
    "result": "success",
    "time": 399,
    "title": "5.1.5 Ensure No World Writable Folders Exist in the System Folder (Automated)"
  },
  {
    "description": "Software sometimes insists on being installed in the /System/Volumes/Data/Library Directory and has inappropriate world-writable permissions.",
    "id": "5_1_6",
    "regex": "0",
    "result": "fail",
    "time": 3630,
    "title": "5.1.6 Ensure No World Writable Folders Exist in the Library Folder (Automated)"
  },
  {
    "description": "The account lockout threshold specifies the amount of times a user can enter an incorrect password before a lockout will occur. \n\nEnsure that a lockout threshold is part of the password policy on the computer.",
    "id": "5_2_1",
    "regex": "^[12345]$",
    "result": "success",
    "time": 20,
    "title": "5.2.1 Ensure Password Account Lockout Threshold Is Configured (Automated)"
  },
  {
    "description": "A minimum password length is the fewest number of characters a password can contain to meet a system's requirements. \n\nEnsure that a minimum of a 15-character password is part of the password policy on the computer. \n\nWhere the confidentiality of encrypted information in FileVault is more of a concern, requiring a longer password or passphrase may be sufficient rather than imposing additional complexity requirements that may be self-defeating.",
    "id": "5_2_2",
    "regex": "^(?:1[5-9]|[2-9]\\d+)$",
    "result": "fail",
    "time": 17,
    "title": "5.2.2 Ensure Password Minimum Length Is Configured (Automated)"
  },
  {
    "description": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non- alphanumeric characters. \n\nEnsure that an Alphabetic character is part of the password policy on the computer.",
    "id": "5_2_3",
    "regex": "true",
    "result": "fail",
    "time": 23,
    "title": "5.2.3 Ensure Complex Password Must Contain Alphabetic Characters Is Configured (Automated)"
  },
  {
    "description": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. \n\nEnsure that a number or numeric value is part of the password policy on the computer.",
    "id": "5_2_4",
    "regex": "true",
    "result": "fail",
    "time": 23,
    "title": "5.2.4 Ensure Complex Password Must Contain Numeric Character Is Configured (Automated)"
  },
  {
    "description": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non- alphanumeric characters. Ensure that a special character is part of the password policy on the computer.",
    "id": "5_2_5",
    "regex": "true",
    "result": "fail",
    "time": 24,
    "title": "5.2.5 Ensure Complex Password Must Contain Special Character Is Configured (Automated)"
  },
  {
    "description": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. \n\nEnsure that both uppercase and lowercase letters are part of the password policy on the computer.",
    "id": "5_2_6",
    "regex": "true",
    "result": "fail",
    "time": 18,
    "title": "5.2.6 Ensure Complex Password Must Contain Uppercase and Lowercase Characters Is Configured (Automated)"
  },
  {
    "description": "Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users should reset passwords periodically. This control uses 365 days as the acceptable value. Some organizations may be more or less restrictive. This control mainly exists to mitigate against password reuse of the macOS account password in other realms that may be more prone to compromise. Attackers take advantage of exposed information to attack other accounts.",
    "id": "5_2_7",
    "regex": "true",
    "result": "fail",
    "time": 17,
    "title": "5.2.7 Ensure Password Age Is Configured (Automated)"
  },
  {
    "description": "Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous password hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15. The latest NIST guidance based on exploit research referenced in this section details how one of the greatest risks is password exposure rather than password cracking. Passwords should be changed to a new unique value whenever a password might have been exposed to anyone other than the account holder. Attackers have maintained persistent control based on predictable password change patterns and substantially different patterns should be used in case of a leak.",
    "id": "5_2_8",
    "regex": "true",
    "result": "error",
    "time": 4,
    "title": "5.2.8 Ensure Password History Is Configured (Automated)"
  },
  {
    "description": "The sudo command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system. This control, along with the control to use a separate timestamp for each tty, limits the window where an unauthorized user, process, or attacker could utilize legitimate credentials that are valid for longer than required.",
    "id": "5_3",
    "regex": "1",
    "result": "error",
    "time": 16,
    "title": "5.3 Ensure the Sudo Timeout Period Is Set to Zero (Automated)"
  },
  {
    "description": "Using tty tickets ensures that a user must enter the sudo password in each Terminal session. \n\nWith sudo versions 1.8 and higher, introduced in 10.12, the default value is to have tty tickets for each interface so that root access is limited to a specific terminal. The default configuration can be overwritten or not configured correctly on earlier versions of macOS.",
    "id": "5_4",
    "regex": "true",
    "result": "fail",
    "time": 15,
    "title": "5.4 Ensure a Separate Timestamp Is Enabled for Each User/tty Combo (Automated)"
  },
  {
    "description": "The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. With some versions of Linux, the system administrator may commonly use the root account to perform administrative functions.",
    "id": "5_5",
    "regex": "No such key: AuthenticationAuthority",
    "result": "fail",
    "time": 21,
    "title": "5.5 Ensure the \"root\" Account Is Disabled (Automated)"
  },
  {
    "description": "macOS has a privilege that can be granted to any user that will allow that user to unlock active users' sessions.",
    "id": "5_6",
    "regex": "1",
    "result": "success",
    "time": 20,
    "title": "5.6 Ensure an Administrator Account Cannot Login to Another User's Active and Locked Session (Automated)"
  },
  {
    "description": "A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required. The system recognizes either the .txt and the .rtf formats",
    "id": "5_7",
    "regex": "^(?!.*no matches found).+$",
    "result": "error",
    "time": 13,
    "title": "5.7 Ensure a Login Window Banner Exists (Automated)"
  },
  {
    "description": "In the previous two controls, the guest account login has been disabled and sharing to guests has been disabled, as well. There is no need for the legacy Guest home folder to remain in the file system. When normal user accounts are removed, you have the option to archive it, leave it in place, or delete. In the case of the guest folder, the folder remains in place without a GUI option to remove it. If at some point in the future a Guest account is needed, it will be re-created. The presence of the Guest home folder can cause automated audits to fail when looking for compliant settings within all User folders, as well. Rather than ignoring the folder's continued existence, it is best removed.",
    "id": "5_8",
    "regex": "^$",
    "result": "error",
    "time": 13,
    "title": "5.8 Ensure the Guest Home Folder Does Not Exist (Automated)"
  },
  {
    "description": "XProtect is Apple's native signature-based antivirus technology. XProtect both finds and blocks the execution of known malware. There are many AV and Endpoint Threat Detection and Response (ETDR) tools available for Mac OS. The native Apple provisioned tool looks for specific known malware and is completely integrated into the OS. No matter what other tools are being used, XProtect should have the latest signatures available.",
    "id": "5_9",
    "regex": "XProtect launch scans: enabled.*XProtect background scans: enabled",
    "result": "fail",
    "time": 14,
    "title": "5.9 Ensure XProtect Is Running and Updated (Automated)"
  },
  {
    "description": "Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal. Unauthorized applications and malicious code could intercept keystrokes entered in the Terminal.",
    "id": "5_10",
    "regex": "true",
    "result": "fail",
    "time": 17,
    "title": "5.10 Ensure Secure Keyboard Entry Terminal.app Is Enabled (Automated)"
  },
  {
    "description": "A filename extension is a suffix added to a base filename that indicates the base filename's file format.",
    "id": "5_11",
    "regex": "1",
    "result": "error",
    "time": 16,
    "title": "5.11 Ensure Show All Filename Extensions Setting is Enabled (Automated)"
  },
  {
    "description": "In order to properly monitor the use of the sudo command, logs events for any use of sudo should be captured in the unified log.",
    "id": "5_12",
    "regex": "1",
    "result": "error",
    "time": 15,
    "title": "5.12 Ensure Logging Is Enabled for Sudo (Automated)"
  }
]