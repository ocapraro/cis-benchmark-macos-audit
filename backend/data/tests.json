[{"description":"Software vendors release security patches and software updates for their products\nwhen security vulnerabilities are discovered. There is no simple way to complete this\naction without a network connection to an Apple software repository. Please ensure\nappropriate access for this control. This check is only for what Apple provides through\nsoftware update.\nSoftware updates should be run at minimum every 30 days. Run the following command\nto verify when software update was previously run:\n$ /usr/bin/sudo defaults read\n/Library/Preferences/com.apple.SoftwareUpdate | grep -e\nLastFullSuccessfulDate.\nThe response should be in the last 30 days (Example): LastFullSuccessfulDate =\n\"2020-07-30 12:45:25 +0000\";","id":"1_1","regex":"No new software available","result":"fail","time":4509,"title":"1.1 Ensure All Apple-provided Software Is Current (Automated)"},{"description":"Auto Update verifies that your system has the newest security patches and software\nupdates. If \"Automatically check for updates\" is not selected, background updates for\nnew malware definition files from Apple for XProtect and Gatekeeper will not occur.\nhttp://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/\nhttps://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-\nmavericks-and-yosemite/","id":"1_2","regex":"true","result":"fail","time":35,"title":"1.2 Ensure Auto Update Is Enabled (Automated)"},{"description":"In the GUI, both \"Install macOS updates\" and \"Install app updates from the App Store\" are dependent on whether \"Download new updates when available\" is selected.","id":"1_3","regex":"true","result":"success","time":28,"title":"1.3 Ensure Download New Updates When Available Is Enabled (Automated)"},{"description":"Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to test first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off simply to allow the administrator to contact users in order to verify installation. A dependable, repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.","id":"1_4","regex":"true","result":"success","time":27,"title":"1.4 Ensure Install of macOS Updates Is Enabled (Automated)"},{"description":"Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or administrator privileges for end users.","id":"1_5","regex":"true","result":"fail","time":27,"title":"1.5 Ensure Install Application Updates from the App Store Is Enabled (Automated)"},{"description":"Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper. With this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights. Apple has introduced a security feature that allows for smaller downloads and the installation of security updates when a reboot is not required. This feature is only available when the last regular update has already been applied. This feature emphasizes that a Mac must be up-to-date on patches so that Apple's security tools can be used to quickly patch when a rapid response is necessary.","id":"1_6","regex":"true","result":"success","time":26,"title":"1.6 Ensure Install Security Responses and System Files Is Enabled (Automated)"},{"description":"A firewall is a piece of software that blocks unwanted incoming connections to a system.","id":"2_1_1","regex":"true","result":"success","time":26,"title":"2.1.1 Ensure Firewall Is Enabled (Automated)"},{"description":"While in Stealth mode, the computer will not respond to unsolicited probes, dropping that traffic.","id":"2_1_2","regex":"Firewall stealth mode is on","result":"success","time":7,"title":"2.1.2 Ensure Firewall Stealth Mode Is Enabled (Automated)"},{"description":"Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.\n\nNote: If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required, use the Date & Time System Preference with each server separated by a space. \n\nAdditional Note: The default Apple time server is time.apple.com. Variations include time.euro.apple.com. While it is certainly more efficient to use internal time servers, there is no reason to block access to global Apple time servers or to add a time.apple.com alias to internal DNS records. There are no reports that Apple gathers any information from NTP synchronization, as the computers already phone home to Apple for Apple services including iCloud use and software updates. Best practice is to allow DNS resolution to an authoritative time service for time.apple.com, preferably to connect to Apple servers, but local servers are acceptable as well.","id":"2_2_1_1","regex":"On","result":"fail","time":22,"title":"2.2.1.1 Ensure Set Time and Date Automatically Is Enabled (Automated)"},{"description":"In macOS 10.14, Apple replace ntp with timed for time services, and is used to ensure correct time is kept. Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.","id":"2_2_1_2","regex":"1","result":"success","time":17,"title":"2.2.1.2 Ensure the Time Service Is Enabled (Automated)"},{"description":"Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.","id":"2_2_2_1","regex":"Remote Apple Events: Off","result":"success","time":22,"title":"2.2.2.1 Ensure Remote Apple Events Is Disabled (Automated)"},{"description":"Starting with 10.13 (macOS High Sierra), Apple introduced a service to make it easier to deploy data from Apple, including software updates, where there are bandwidth constraints to the Internet and fewer constraints or greater bandwidth exist on the local subnet. This capability can be very valuable for organizations that have throttled and possibly metered Internet connections. In heterogeneous enterprise networks with multiple subnets, the effectiveness of this capability would be determined by how many Macs were on each subnet at the time new, large updates were made available upstream. This capability requires the use of mac OS clients as P2P nodes for updated Apple content. Unless there is a business requirement to manage operational Internet connectivity and bandwidth, user endpoints should not store content and act as a cluster to provision data.","id":"2_2_2_2","regex":"false","result":"success","time":26,"title":"2.2.2.2 Ensure Content Caching Is Disabled (Automated)"},{"description":"Apple provides a mechanism to send diagnostic and analytics data back to Apple to help them improve the platform. Information sent to Apple may contain internal organizational information that should be controlled and not available for processing by Apple. Turn off all Analytics and Improvements sharing.","id":"2_3_1","regex":"0\n0\n2","result":"success","time":40,"title":"2.3.1 Ensure Sending Diagnostic and Usage Data to Apple Is Disabled (Automated)"},{"description":"","id":"","regex":"true","result":"error","time":3,"title":""}]